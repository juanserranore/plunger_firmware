\doxysection{Setup29b\+\_\+\+ILI9341\+\_\+\+STM32.\+h}
\label{_setup29b___i_l_i9341___s_t_m32_8h_source}\index{lib/TFT\_eSPI-\/master/User\_Setups/Setup29b\_ILI9341\_STM32.h@{lib/TFT\_eSPI-\/master/User\_Setups/Setup29b\_ILI9341\_STM32.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ STM32}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#define\ NUCLEO\_64\_TFT}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\#define\ TFT\_INVERSION\_OFF}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#define\ TFT\_WIDTH\ \ 240}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ TFT\_HEIGHT\ 320}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#define\ ST7789\_DRIVER}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ TFT\_RGB\_ORDER\ TFT\_BGR}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#define\ TFT\_SPI\_PORT\ 1\ }\textcolor{comment}{//\ SPI\ 1\ maximum\ clock\ rate\ is\ 55MHz}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#define\ TFT\_MOSI\ D11}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ TFT\_MISO\ D12}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#define\ TFT\_SCLK\ D13}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{comment}{//\ Can\ use\ Ardiuno\ pin\ references,\ arbitrary\ allocation,\ TFT\_eSPI\ controls\ chip\ select}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#define\ TFT\_CS\ \ \ D5\ }\textcolor{comment}{//\ Chip\ select\ control\ pin\ to\ TFT\ CS}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#define\ TFT\_DC\ \ \ D6\ }\textcolor{comment}{//\ Data\ Command\ control\ pin\ to\ TFT\ DC\ (may\ be\ labelled\ RS\ =\ Register\ Select)}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#define\ TFT\_RST\ \ D7\ }\textcolor{comment}{//\ Reset\ pin\ to\ TFT\ RST\ (or\ RESET)}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#define\ LOAD\_GLCD\ \ \ }\textcolor{comment}{//\ Font\ 1.\ Original\ Adafruit\ 8\ pixel\ font\ needs\ \string~1820\ bytes\ in\ FLASH}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#define\ LOAD\_FONT2\ \ }\textcolor{comment}{//\ Font\ 2.\ Small\ 16\ pixel\ high\ font,\ needs\ \string~3534\ bytes\ in\ FLASH,\ 96\ characters}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#define\ LOAD\_FONT4\ \ }\textcolor{comment}{//\ Font\ 4.\ Medium\ 26\ pixel\ high\ font,\ needs\ \string~5848\ bytes\ in\ FLASH,\ 96\ characters}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#define\ LOAD\_FONT6\ \ }\textcolor{comment}{//\ Font\ 6.\ Large\ 48\ pixel\ font,\ needs\ \string~2666\ bytes\ in\ FLASH,\ only\ characters\ 1234567890:-\/.apm}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#define\ LOAD\_FONT7\ \ }\textcolor{comment}{//\ Font\ 7.\ 7\ segment\ 48\ pixel\ font,\ needs\ \string~2438\ bytes\ in\ FLASH,\ only\ characters\ 1234567890:-\/.}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#define\ LOAD\_FONT8\ \ }\textcolor{comment}{//\ Font\ 8.\ Large\ 75\ pixel\ font\ needs\ \string~3256\ bytes\ in\ FLASH,\ only\ characters\ 1234567890:-\/.}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ LOAD\_GFXFF\ \ }\textcolor{comment}{//\ FreeFonts.\ Include\ access\ to\ the\ 48\ Adafruit\_GFX\ free\ fonts\ FF1\ to\ FF48\ and\ custom\ fonts}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{comment}{//\ STM32\ support\ for\ smooth\ fonts\ via\ program\ memory\ (FLASH)\ arrays}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#define\ SMOOTH\_FONT}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ SPI\_FREQUENCY\ \ 55000000\ \ \ }\textcolor{comment}{//\ 27MHz\ SPI\ clock}}
\DoxyCodeLine{00036\ \textcolor{comment}{//\#define\ SPI\_FREQUENCY\ \ 55000000\ \ \ //\ 55MHz\ is\ over-\/clocking\ ILI9341\ but\ seems\ to\ work\ reliably!}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#define\ SPI\_READ\_FREQUENCY\ \ 15000000\ }\textcolor{comment}{//\ Reads\ need\ a\ slower\ SPI\ clock,\ probably\ ends\ up\ at\ 13.75MHz\ (CPU\ clock/16)}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{comment}{//\ This\ has\ no\ effect,\ transactions\ for\ STM32\ are\ automatically\ enabled}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#define\ SUPPORT\_TRANSACTIONS}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{comment}{/*}}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ //\ \ Setup\ for\ STM32\ Nucleo\ and\ ILI9341\ display\ \ \ //}
\DoxyCodeLine{00047\ \#define\ USER\_SETUP\_ID\ 29}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ //\ Last\ update\ by\ Bodmer:\ 28/11/19}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ //\ STM32\ optimised\ functions\ are\ not\ yet\ compatible\ with\ STM32H743\ processor.}
\DoxyCodeLine{00052\ //\ The\ STM32H743\ does\ work\ with\ the\ slower\ generic\ processor\ drivers}
\DoxyCodeLine{00053\ //}
\DoxyCodeLine{00054\ //\ REMINDER\ -\/\ Nucleo-\/F743ZI\ and\ Nucleo-\/F743ZI2\ have\ different\ pin\ port\ allocations}
\DoxyCodeLine{00055\ //\ and\ require\ appropriate\ selection\ in\ IDE.\ \string^-\/-\/-\/-\/\ Note\ the\ extra\ 2\ in\ part\ number!}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ //\ Define\ STM32\ to\ invoke\ STM32\ optimised\ driver}
\DoxyCodeLine{00059\ \#define\ STM32}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ //\ Define\ the\ TFT\ display\ driver}
\DoxyCodeLine{00062\ //\#define\ ILI9341\_DRIVER}
\DoxyCodeLine{00063\ //\#define\ ILI9481\_DRIVER}
\DoxyCodeLine{00064\ \#define\ ST7789\_DRIVER}
\DoxyCodeLine{00065\ \#define\ TFT\_RGB\_ORDER\ TFT\_BGR}
\DoxyCodeLine{00066\ //\ MOSI\ and\ SCK\ do\ not\ need\ to\ be\ defined,\ connect:}
\DoxyCodeLine{00067\ //\ \ -\/\ Arduino\ SCK\ \ to\ TFT\ SCK}
\DoxyCodeLine{00068\ //\ \ -\/\ Arduino\ MOSI\ to\ TFT\ SDI(may\ be\ marked\ SDA\ or\ MOSI)}
\DoxyCodeLine{00069\ //\ Typical\ Arduino\ SPI\ port\ 1\ pins\ are\ (SCK=D13,\ MISO=D12,\ MOSI=D11)\ this\ is\ port\ pins\ PA5,\ PA6\ and\ PA7\ on\ Nucleo-\/F767ZI}
\DoxyCodeLine{00070\ //\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SPI\ port\ 2\ pins\ are\ (SCK=D18,\ MISO=A7,\ MOSI=D17)\ this\ is\ port\ pins\ PB13,\ PC2\ and\ PB15\ on\ Nucleo-\/F767ZI}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ //*}
\DoxyCodeLine{00073\ \#define\ TFT\_SPI\_PORT\ 1\ //\ SPI\ 1\ maximum\ clock\ rate\ is\ 55MHz}
\DoxyCodeLine{00074\ \#define\ TFT\_MOSI\ PA7}
\DoxyCodeLine{00075\ \#define\ TFT\_MISO\ PA6}
\DoxyCodeLine{00076\ \#define\ TFT\_SCLK\ PA5}
\DoxyCodeLine{00077\ //*/}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \textcolor{comment}{/*}}
\DoxyCodeLine{00080\ \textcolor{comment}{\#define\ TFT\_SPI\_PORT\ 2\ //\ SPI\ 2\ maximum\ clock\ rate\ is\ 27MHz}}
\DoxyCodeLine{00081\ \textcolor{comment}{\#define\ TFT\_MOSI\ D17}}
\DoxyCodeLine{00082\ \textcolor{comment}{\#define\ TFT\_MISO\ A7}}
\DoxyCodeLine{00083\ \textcolor{comment}{\#define\ TFT\_SCLK\ D18}}
\DoxyCodeLine{00084\ \textcolor{comment}{//*/}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \textcolor{comment}{/*}}
\DoxyCodeLine{00087\ \textcolor{comment}{\#define\ TFT\_SPI\_PORT\ 2\ //\ SPI\ 2\ maximum\ clock\ rate\ is\ 27MHz}}
\DoxyCodeLine{00088\ \textcolor{comment}{\#define\ TFT\_MOSI\ PB15}}
\DoxyCodeLine{00089\ \textcolor{comment}{\#define\ TFT\_MISO\ PC2}}
\DoxyCodeLine{00090\ \textcolor{comment}{\#define\ TFT\_SCLK\ PB13}}
\DoxyCodeLine{00091\ \textcolor{comment}{//*/}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \textcolor{comment}{/*}}
\DoxyCodeLine{00094\ \textcolor{comment}{\#define\ TFT\_SPI\_PORT\ 2\ //\ SPI\ 2\ maximum\ clock\ rate\ is\ 27MHz}}
\DoxyCodeLine{00095\ \textcolor{comment}{\#define\ TFT\_MOSI\ PB15}}
\DoxyCodeLine{00096\ \textcolor{comment}{\#define\ TFT\_MISO\ PB14}}
\DoxyCodeLine{00097\ \textcolor{comment}{\#define\ TFT\_SCLK\ PB13}}
\DoxyCodeLine{00098\ \textcolor{comment}{//*/}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{comment}{/*}}
\DoxyCodeLine{00101\ \textcolor{comment}{//\ Can\ use\ Ardiuno\ pin\ references,\ arbitrary\ allocation,\ TFT\_eSPI\ controls\ chip\ select}}
\DoxyCodeLine{00102\ \textcolor{comment}{\#define\ TFT\_CS\ \ \ D5\ //\ Chip\ select\ control\ pin\ to\ TFT\ CS}}
\DoxyCodeLine{00103\ \textcolor{comment}{\#define\ TFT\_DC\ \ \ D6\ //\ Data\ Command\ control\ pin\ to\ TFT\ DC\ (may\ be\ labelled\ RS\ =\ Register\ Select)}}
\DoxyCodeLine{00104\ \textcolor{comment}{\#define\ TFT\_RST\ \ D7\ //\ Reset\ pin\ to\ TFT\ RST\ (or\ RESET)}}
\DoxyCodeLine{00105\ \textcolor{comment}{}}
\DoxyCodeLine{00106\ \textcolor{comment}{//\ Alternatively,\ we\ can\ use\ STM32\ port\ reference\ names\ PXnn}}
\DoxyCodeLine{00107\ \textcolor{comment}{//\#define\ TFT\_CS\ \ \ PE11\ //\ Nucleo-\/F767ZI\ equivalent\ of\ D5}}
\DoxyCodeLine{00108\ \textcolor{comment}{//\#define\ TFT\_DC\ \ \ PE9\ \ //\ Nucleo-\/F767ZI\ equivalent\ of\ D6}}
\DoxyCodeLine{00109\ \textcolor{comment}{//\#define\ TFT\_RST\ \ PF13\ //\ Nucleo-\/F767ZI\ equivalent\ of\ D7}}
\DoxyCodeLine{00110\ \textcolor{comment}{}}
\DoxyCodeLine{00111\ \textcolor{comment}{//\#define\ TFT\_RST\ \ -\/1\ \ \ //\ Set\ TFT\_RST\ to\ -\/1\ if\ the\ display\ RESET\ is\ connected\ to\ processor\ reset}}
\DoxyCodeLine{00112\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ Use\ an\ Arduino\ pin\ for\ initial\ testing\ as\ connecting\ to\ processor\ reset}}
\DoxyCodeLine{00113\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ //\ may\ not\ work\ (pulse\ too\ short\ at\ power\ up?)}}
\DoxyCodeLine{00114\ \textcolor{comment}{}}
\DoxyCodeLine{00115\ \textcolor{comment}{//\ Chip\ select\ for\ XPT2046\ touch\ controller}}
\DoxyCodeLine{00116\ \textcolor{comment}{\#define\ TOUCH\_CS\ D4}}
\DoxyCodeLine{00117\ \textcolor{comment}{}}
\DoxyCodeLine{00118\ \textcolor{comment}{\#define\ LOAD\_GLCD\ \ \ //\ Font\ 1.\ Original\ Adafruit\ 8\ pixel\ font\ needs\ \string~1820\ bytes\ in\ FLASH}}
\DoxyCodeLine{00119\ \textcolor{comment}{\#define\ LOAD\_FONT2\ \ //\ Font\ 2.\ Small\ 16\ pixel\ high\ font,\ needs\ \string~3534\ bytes\ in\ FLASH,\ 96\ characters}}
\DoxyCodeLine{00120\ \textcolor{comment}{\#define\ LOAD\_FONT4\ \ //\ Font\ 4.\ Medium\ 26\ pixel\ high\ font,\ needs\ \string~5848\ bytes\ in\ FLASH,\ 96\ characters}}
\DoxyCodeLine{00121\ \textcolor{comment}{\#define\ LOAD\_FONT6\ \ //\ Font\ 6.\ Large\ 48\ pixel\ font,\ needs\ \string~2666\ bytes\ in\ FLASH,\ only\ characters\ 1234567890:-\/.apm}}
\DoxyCodeLine{00122\ \textcolor{comment}{\#define\ LOAD\_FONT7\ \ //\ Font\ 7.\ 7\ segment\ 48\ pixel\ font,\ needs\ \string~2438\ bytes\ in\ FLASH,\ only\ characters\ 1234567890:-\/.}}
\DoxyCodeLine{00123\ \textcolor{comment}{\#define\ LOAD\_FONT8\ \ //\ Font\ 8.\ Large\ 75\ pixel\ font\ needs\ \string~3256\ bytes\ in\ FLASH,\ only\ characters\ 1234567890:-\/.}}
\DoxyCodeLine{00124\ \textcolor{comment}{\#define\ LOAD\_GFXFF\ \ //\ FreeFonts.\ Include\ access\ to\ the\ 48\ Adafruit\_GFX\ free\ fonts\ FF1\ to\ FF48\ and\ custom\ fonts}}
\DoxyCodeLine{00125\ \textcolor{comment}{}}
\DoxyCodeLine{00126\ \textcolor{comment}{//\ STM32\ support\ for\ smooth\ fonts\ via\ program\ memory\ (FLASH)\ arrays}}
\DoxyCodeLine{00127\ \textcolor{comment}{\#define\ SMOOTH\_FONT}}
\DoxyCodeLine{00128\ \textcolor{comment}{}}
\DoxyCodeLine{00129\ \textcolor{comment}{}}
\DoxyCodeLine{00130\ \textcolor{comment}{//\ Nucleo-\/F767ZI\ has\ a\ \string~216MHZ\ CPU\ clock,\ this\ is\ divided\ by\ 4,\ 8,\ 16\ etc.}}
\DoxyCodeLine{00131\ \textcolor{comment}{}}
\DoxyCodeLine{00132\ \textcolor{comment}{\#define\ SPI\_FREQUENCY\ \ 27000000\ \ \ //\ 27MHz\ SPI\ clock}}
\DoxyCodeLine{00133\ \textcolor{comment}{//\#define\ SPI\_FREQUENCY\ \ 55000000\ \ \ //\ 55MHz\ is\ over-\/clocking\ ILI9341\ but\ seems\ to\ work\ reliably!}}
\DoxyCodeLine{00134\ \textcolor{comment}{}}
\DoxyCodeLine{00135\ \textcolor{comment}{\#define\ SPI\_READ\_FREQUENCY\ \ 15000000\ //\ Reads\ need\ a\ slower\ SPI\ clock,\ probably\ ends\ up\ at\ 13.75MHz\ (CPU\ clock/16)}}
\DoxyCodeLine{00136\ \textcolor{comment}{}}
\DoxyCodeLine{00137\ \textcolor{comment}{\#define\ SPI\_TOUCH\_FREQUENCY\ \ 2500000\ //\ Must\ be\ very\ slow}}
\DoxyCodeLine{00138\ \textcolor{comment}{}}
\DoxyCodeLine{00139\ \textcolor{comment}{//\ This\ has\ no\ effect,\ transactions\ for\ STM32\ are\ automatically\ enabled}}
\DoxyCodeLine{00140\ \textcolor{comment}{\#define\ SUPPORT\_TRANSACTIONS}}
\DoxyCodeLine{00141\ \textcolor{comment}{*/}}

\end{DoxyCode}
